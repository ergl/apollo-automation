{run_template, "run.config.template"}.
{cluster_template, "cluster.config.template"}.

%% Syntax for each experiment:
%% #{
%%     %% Number of threads per client machine.
%%     %% Allowed values are numbers (like `1`, `20`, etc), list of numbers,
%%     %% or a MFA ({M, F, A}) that in the end produces a generator of numbers
%%     %% For example, the line below produces the list [0, 50, 100]
%%     %% NOTE: The minimum number of workers is 1. All values less than 1 will be set to 1.
%%     clients => {lists, seq, [0, 100, 50]},
%%
%%     %% The folder name under $HOME/results where all results for this test will go
%%     results_folder => "test_name",
%%
%%     %% A map of template subsitutions.
%%     %% Check run.config.template for available values.
%%     %% In essence, anything present below will be changed in the corresponding
%%     %% run.config file supplied to the benchmark.
%%     %% Any key will be overriden, but the minimum amount of keys to be present
%%     is shown below.
%%     run_with => #{
%%         operations => [{read, 1}],
%%         readonly_ops => 1,
%%         retry_aborts => false
%%     },
%%
%%    %% A map of config template subsitutions.
%%    %% Check cluster.config.template for available values.
%%    %% For the `clusters` key, you can either input a list of replica names,
%%    %% or a raw map like we used in old cluster.config files
%%    run_on => #{
%%        ext_tag => "release-X.Y.Z",
%%        clusters => [virginia],
%%        partitions => 1,
%%        per_partition => 4
%%    }
%% }.

{experiments,
    [
        #{
            results_folder => "uniform_200k_veleta_non_tx",
            clients => [0, 50, 100, 150, 300, 600, 800, 1000],
            run_on => #{
                ext_tag => "release-0.1.11-no-tx-reads",
                clusters => [virginia],
                partitions => 1,
                per_partition => 4
            },
            run_with => #{
                duration => 5,
                key_generator => {{int_to_bin_bigendian, 64}, {uniform_int, 200000}},
                operations => [{read_no_tx,1}],
                readonly_ops => 1,
                retry_aborts => false
            }
        },
        #{
            results_folder => "uniform_200k_veleta_non_tx",
            clients => [0, 50, 100, 150, 300, 600, 800, 1000],
            run_on => #{
                ext_tag => "release-0.1.11-no-tx-reads",
                clusters => [virginia],
                partitions => 2,
                per_partition => 4
            },
            run_with => #{
                duration => 5,
                key_generator => {{int_to_bin_bigendian, 64}, {uniform_int, 200000}},
                operations => [{read_no_tx,1}],
                readonly_ops => 1,
                retry_aborts => false
            }
        },
        #{
            results_folder => "uniform_200k_veleta_non_tx",
            clients => [0, 25, 100, 150, 300, 600, 800, 1000, 1200, 1400],
            run_on => #{
                ext_tag => "release-0.1.11-no-tx-reads",
                clusters => [virginia],
                partitions => 4,
                per_partition => auto
            },
            run_with => #{
                duration => 5,
                key_generator => {{int_to_bin_bigendian, 64}, {uniform_int, 200000}},
                operations => [{read_no_tx,1}],
                readonly_ops => 1,
                retry_aborts => false
            }
        },
        #{
            results_folder => "uniform_200k_veleta_non_tx",
            clients => [0, 25, 50, 100, 300, 600, 800, 1000, 1500, 2000],
            run_on => #{
                ext_tag => "release-0.1.11-no-tx-reads",
                clusters => [virginia],
                partitions => 6,
                per_partition => 4
            },
            run_with => #{
                duration => 5,
                key_generator => {{int_to_bin_bigendian, 64}, {uniform_int, 200000}},
                operations => [{read_no_tx,1}],
                readonly_ops => 1,
                retry_aborts => false
            }
        },
        #{
            results_folder => "uniform_200k_veleta_fedor_todos",
            clients => [0, 50, 100, 150, 300, 600, 800, 1000],
            run_on => #{
                ext_tag => "release-0.1.11",
                clusters => [virginia],
                partitions => 1,
                per_partition => 4
            },
            run_with => #{
                duration => 5,
                key_generator => {{int_to_bin_bigendian, 64}, {uniform_int, 200000}},
                operations => [{read,1}],
                readonly_ops => 1,
                retry_aborts => false
            }
        },
        #{
            results_folder => "uniform_200k_veleta_fedor_todos",
            clients => [0, 50, 100, 150, 300, 600, 800, 1000],
            run_on => #{
                ext_tag => "release-0.1.11",
                clusters => [virginia],
                partitions => 2,
                per_partition => 4
            },
            run_with => #{
                duration => 5,
                key_generator => {{int_to_bin_bigendian, 64}, {uniform_int, 200000}},
                operations => [{read,1}],
                readonly_ops => 1,
                retry_aborts => false
            }
        },
        #{
            results_folder => "uniform_200k_veleta_fedor_todos",
            clients => [0, 25, 100, 150, 300, 600, 800, 1000, 1200, 1400],
            run_on => #{
                ext_tag => "release-0.1.11",
                clusters => [virginia],
                partitions => 4,
                per_partition => auto
            },
            run_with => #{
                duration => 5,
                key_generator => {{int_to_bin_bigendian, 64}, {uniform_int, 200000}},
                operations => [{read,1}],
                readonly_ops => 1,
                retry_aborts => false
            }
        },
        #{
            results_folder => "uniform_200k_veleta_fedor_todos",
            clients => [0, 25, 50, 100, 300, 600, 800, 1000, 1500, 2000],
            run_on => #{
                ext_tag => "release-0.1.11",
                clusters => [virginia],
                partitions => 6,
                per_partition => 4
            },
            run_with => #{
                duration => 5,
                key_generator => {{int_to_bin_bigendian, 64}, {uniform_int, 200000}},
                operations => [{read,1}],
                readonly_ops => 1,
                retry_aborts => false
            }
        }
    ]
}.
